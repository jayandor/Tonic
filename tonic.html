<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tonic: Music Programming</title>
</head>
<body>
    <button id='play-button'>Play</button>
    <div id="soundStatus"></div>
    
    <script src="webaudio_tools.js"></script>
    <script src="MIDIUtils.js"></script>
    <script src="requestTimeout.js"></script>

    <script src="MyMusic2.js"></script>
    <script src="MyMusicDecoder.js"></script>
    <script>
    // specific musical parameters

    var TEMPO    = 120,    // bpm
        TIME_SIG = 4;     // even numbers are duple, odd are triple, DOESN'T DO ANYTHING AT THE MOMENT

    var KEY = 'A-4';
    KEY = MIDIUtils.noteNameToNoteNumber(KEY);

    var notes_string =
    "\
     0,4 \
     2,4 \
     4,2 \
     0,2 \
     \
     0,4 \
     2,4 \
     4,2 \
     0,2 \
     \
     0,4 \
     2,4 \
     4,2 \
     0,2 \
     \
     0,4 \
     2,4 \
     4,2 \
     0,2 \
     \
     \
     2,4 \
     3,4 \
     1,2 \
     -3,2 \
     \
     2,4 \
     3,4 \
     1,2 \
     -3,2 \
     \
     2,4 \
     3,4 \
     1,2 \
     -3,2 \
     \
     2,4 \
     3,4 \
     1,2 \
     -3,2 \
     \
     \
     1,4 \
     2,4 \
     3,2 \
     -1,2 \
     \
     1,4 \
     2,4 \
     3,2 \
     -1,2 \
     \
     1,4 \
     2,4 \
     3,2 \
     -1,2 \
     \
     1,4 \
     2,4 \
     3,2 \
     -1,2 \
     \
     \
     2,4 \
     1,4 \
     0,2 \
     -4,2 \
     \
     2,4 \
     1,4 \
     0,2 \
     -4,2 \
     \
     2,4 \
     1,4 \
     0,2 \
     -4,2 \
     \
     2,4 \
     1,4 \
     0,2 \
     -4,2 \
     "
    ;
    var notes = MyMusic.common.notes_string_to_notes(notes_string, key = KEY, MyMusic.scales.MINOR);

    var notes_string2 =
    "\
    -17,2  \
    -12,1. \
    -12,1. \
    -12,1. \
    -12,1. \
    \
    -17,1. \
    -17,1. \
    -17,1. \
    -17,1. \
    \
    -14,1. \
    -14,1. \
    -14,1. \
    -14,1. \
    \
    -19,1. \
    -19,1. \
    -19,1. \
    -19,1. \
    "
    ;

    var notes2 = MyMusic.common.notes_string_to_notes( notes_string2, key = MyMusic.common.shift_octave(KEY, -1) );

    // Use audioContext from webaudio_tools.js
    var s1 = new Synth(audioContext, gain=0.1);
    var s2 = new Synth(audioContext, gain=0.17);

    var np = new NotePlayer(s1, notes);
    var np2 = new NotePlayer(s2, notes2);

    var nc = new NoteController(TEMPO);
    nc.add_player(np);
    nc.add_player(np2);

    var play_button = document.getElementById('play-button');
    
    play_button.onclick = function() {
        if (nc.PLAYING) {
            nc.stop();
        } else {
            nc.play();
        }
    };

    </script>
</body>
</html>